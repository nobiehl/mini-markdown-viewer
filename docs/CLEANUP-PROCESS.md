# Repository Cleanup Process

**Version:** 1.0
**Created:** 2025-11-13
**Purpose:** Systematic process for cleaning up development artifacts and keeping repository clean

---

## When to Run Cleanup

Run repository cleanup:
- **After major releases** (v1.X.0 releases)
- **Before starting new feature development**
- **When repository size grows** (> 50 MB)
- **Monthly maintenance** (first week of month)
- **When directed by team lead**

---

## Cleanup Categories

### 1. Binary Artifacts (CRITICAL - Never commit!)

**Location:** Repository root
**Pattern:** `*.exe`, `*.dll` (outside of bin/obj folders)

**Action:**
```bash
# List all executables in root
ls -la *.exe

# Remove all executables
rm -f *.exe
```

**Whitelist Exceptions:**
- NONE - Binaries should NEVER be in Git!
- GitHub Releases store binaries separately

**Prevention:**
- `.gitignore` should cover `*.exe` and `*.dll`
- Check `.gitignore` if binaries appear

---

### 2. Build Artifacts

**Locations:**
- `bin/`, `obj/` folders
- `bin-single/`, `publish/` folders
- `*.user` files (Visual Studio)
- `*.suo`, `*.cache` files

**Action:**
```bash
# Remove build output folders
rm -rf bin-single/
rm -rf markdown-viewer/*/bin/
rm -rf markdown-viewer/*/obj/

# Remove Visual Studio user files
find markdown-viewer/ -name "*.user" -delete
find markdown-viewer/ -name "*.suo" -delete
```

**Whitelist Exceptions:**
- NONE - Build artifacts are regenerated by `dotnet build`

---

### 3. Temporary Test Files

**Locations:**
- Repository root: `test-*.md`, `nul`, `*.tmp`
- `markdown-viewer/` root: `test-*.md`, `test-*.csx`, `*.tmp`

**Pattern:**
- Files starting with `test-` or `Test-`
- Files named `nul` (Windows command output)
- Files with `.tmp`, `.temp` extensions

**Action:**
```bash
# List temporary files
find . -maxdepth 1 -name "test-*.md" -o -name "nul" -o -name "*.tmp"

# Remove temporary files
rm -f test-*.md nul *.tmp
cd markdown-viewer && rm -f test-*.md test-*.csx *.tmp
```

**Whitelist Exceptions:**
- `markdown-viewer/samples/test-*.md` - Example/demo files for users (KEEP!)

---

### 4. Temporary Test Projects

**Locations:**
- `markdown-viewer/TestAnchorGen/` - One-off test project
- Any folder starting with `Test` that's not `Tests` (unit test folder)

**Criteria for Removal:**
- Not referenced in solution file
- Not part of CI/CD pipeline
- One-time debugging/experimental code
- No documentation reference

**Action:**
```bash
# Check if project is in solution
grep -r "TestAnchorGen" markdown-viewer/*.sln

# If not found, remove entire folder
rm -rf markdown-viewer/TestAnchorGen/
```

**Whitelist Exceptions:**
- `markdown-viewer/MarkdownViewer.Tests/` - Official unit test project (KEEP!)

---

### 5. Temporary Documentation

**Location:** `docs/`
**Pattern:** `implementation-plan-*.md`, `TEST-*.md`

**Criteria for Removal (all must be true):**
- Feature is completed (‚úÖ in ROADMAP.md)
- Content is integrated into `impl_progress.md`
- No references from other documentation

**Action:**
```bash
# List temporary docs
ls -la docs/implementation-plan-*.md docs/TEST-*.md

# Check for references
grep -r "implementation-plan-" docs/ --exclude="implementation-plan-*.md"

# If no references found, remove
rm -f docs/implementation-plan-*.md
```

**Whitelist (KEEP - see PROCESS-MODEL.md "Dokumentationsstruktur"):**
- `CHANGELOG.md` ‚úÖ
- `PROCESS-MODEL.md` ‚úÖ
- `ROADMAP.md` ‚úÖ
- `ARCHITECTURE.md` ‚úÖ
- `impl_progress.md` ‚úÖ
- `DEVELOPMENT.md` ‚úÖ
- `DEPLOYMENT-GUIDE.md` ‚úÖ
- `RELEASE-CHECKLIST.md` ‚úÖ
- `TESTING-CHECKLIST.md` ‚úÖ
- `GLOSSARY.md` ‚úÖ
- `USER-GUIDE.md` ‚úÖ
- Feature-specific docs (if referenced in CHANGELOG.md):
  - `UPDATE-MECHANISMUS-DOKUMENTATION.md` ‚úÖ
  - `UPDATE-INTERVALL-FIX.md` ‚úÖ
  - `GITHUB-TOKEN-SUPPORT.md` ‚úÖ

---

### 6. Obsolete Code (_OLD folders)

**Location:** `markdown-viewer/MarkdownViewer/_OLD/`

**Criteria:**
- Code has been refactored and new version exists
- No active references in codebase
- Git history preserves old code if needed

**Action:**
```bash
# List _OLD folders
find markdown-viewer/ -type d -name "_OLD"

# Check for any imports/references
grep -r "_OLD" markdown-viewer/MarkdownViewer/ --exclude-dir="_OLD"

# If no references, mark for deletion in git
git rm -r markdown-viewer/MarkdownViewer/_OLD/
```

**Prevention:**
- Don't create `_OLD` folders - use Git branches instead!
- If you need to preserve old code temporarily:
  - Create a branch: `git branch archive/old-architecture`
  - Delete old code from main branch
  - Old code is preserved in branch and Git history

---

## Cleanup Workflow

### Step 1: Analyze Current State

```bash
# Check repository status
git status

# Check repository size
du -sh .

# List all untracked files
git status --untracked-files=all

# Find large files
find . -type f -size +1M | head -20
```

### Step 2: Create Cleanup Plan

Document what will be removed:
```markdown
## Cleanup Plan - [Date]

### To Remove:
- [ ] MarkdownViewer-v1.8.0.exe (3.3 MB)
- [ ] MarkdownViewer-v1.9.0.exe (3.3 MB)
- [ ] MarkdownViewer.exe (3.3 MB)
- [ ] nul file
- [ ] test-live-reload.md
- [ ] markdown-viewer/TestAnchorGen/ folder
- [ ] docs/implementation-plan-raw-data-view.md

### To Keep:
- markdown-viewer/samples/ (user examples)
- All official documentation (see whitelist)

**Total Space Saved:** ~10 MB
```

### Step 3: Execute Cleanup

Run cleanup commands from categories 1-6 above.

**IMPORTANT:** Always review `git status` before committing!

### Step 4: Update .gitignore

Ensure cleanup artifacts don't come back:

```bash
# Add to .gitignore if missing
cat >> .gitignore << 'EOF'
# Release binaries (use GitHub Releases instead)
*.exe
*.dll

# Build artifacts
bin/
obj/
bin-single/
publish/

# Temporary test files
test-*.md
nul
*.tmp
*.temp

# Test projects (not Tests/)
Test*/

# IDE files
*.user
*.suo
.vs/
EOF
```

### Step 5: Commit Cleanup

```bash
# Stage all deletions
git add -A

# Commit with clear message
git commit -m "chore: Repository cleanup - remove build artifacts and temporary files

Removed:
- Binary artifacts (*.exe files)
- Temporary test files (test-*.md, nul)
- Obsolete code (_OLD folders)
- Temporary documentation (implementation-plan-*.md)
- One-off test projects (TestAnchorGen)

Space saved: ~10 MB

See docs/CLEANUP-PROCESS.md for details.

ü§ñ Generated with Claude Code

Co-Authored-By: Claude <noreply@anthropic.com>"

# Push to remote
git push origin master
```

---

## Verification Checklist

After cleanup, verify:

- [ ] No `*.exe` files in repository root
- [ ] No `nul` files anywhere
- [ ] No `test-*.md` files in root or `markdown-viewer/` root
- [ ] No `_OLD/` folders
- [ ] No temporary implementation plans in `docs/`
- [ ] All whitelisted documentation present
- [ ] `.gitignore` updated to prevent recurrence
- [ ] Repository size decreased
- [ ] `git status` shows clean working tree
- [ ] Build still works: `dotnet build`
- [ ] Tests still pass: `dotnet test`

---

## Automated Cleanup Script

Create `scripts/cleanup.sh` for automated cleanup:

```bash
#!/bin/bash
# Repository Cleanup Script
# Run from repository root

echo "üßπ Starting repository cleanup..."

# Remove binaries from root
echo "Removing binaries..."
rm -f *.exe *.dll

# Remove temporary files
echo "Removing temporary files..."
rm -f nul test-*.md *.tmp *.temp
cd markdown-viewer && rm -f test-*.md test-*.csx *.tmp && cd ..

# Remove build artifacts
echo "Removing build artifacts..."
rm -rf bin-single/

# List what needs manual review
echo ""
echo "‚ö†Ô∏è Manual review needed:"
git status --untracked-files=all | grep -E "TestAnchorGen|implementation-plan|_OLD"

echo ""
echo "‚úÖ Automated cleanup complete!"
echo "üìã Review 'git status' and commit changes."
```

---

## Common Mistakes to Avoid

### ‚ùå DON'T:
- Delete `markdown-viewer/samples/` (user examples!)
- Delete `markdown-viewer/MarkdownViewer.Tests/` (unit tests!)
- Delete feature documentation referenced in CHANGELOG.md
- Delete without checking `git status` first
- Commit cleanup without testing (`dotnet build && dotnet test`)

### ‚úÖ DO:
- Review `git status` before and after cleanup
- Check .gitignore prevents artifacts from coming back
- Test build and tests after cleanup
- Document what was removed in commit message
- Keep a cleanup log in this document

---

## Cleanup History

Keep a log of major cleanups:

### [2025-11-13] Initial Repository Cleanup
**Trigger:** After v1.9.0 release
**Removed:**
- 3x *.exe files from root (~10 MB)
- nul file
- test-live-reload.md
- markdown-viewer/TestAnchorGen/ folder
- markdown-viewer/test-*.md and test-*.csx files
- docs/implementation-plan-raw-data-view.md
- markdown-viewer/MarkdownViewer/_OLD/ folder (already deleted in git)
- markdown-viewer/MarkdownViewer/bin-single-optimized/ folder (already deleted in git)
- samples/ folder from root (moved to markdown-viewer/samples/)

**Space Saved:** ~10-15 MB
**Status:** ‚úÖ Completed
**Verified:** Build and tests passing

---

**Maintained By:** Development Team
**Last Updated:** 2025-11-13
